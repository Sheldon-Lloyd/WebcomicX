var tinymce=null,tinyMCEPopup,tinyMCE;tinyMCEPopup={init:function(){var b=this,d,c,a;d=b.getWin();tinymce=d.tinymce;tinyMCE=d.tinyMCE;b.editor=tinymce.EditorManager.activeEditor;b.params=b.editor.windowManager.params;b.features=b.editor.windowManager.features;a=b.editor.settings;if(a.popup_css!==false){if(a.popup_css){a.popup_css=b.documentBaseURI.toAbsolute(a.popup_css)}else{a.popup_css=b.baseURI.toAbsolute("themes/"+a.theme+"/skins/"+a.skin+"/dialog.css")}}if(a.popup_css_add){a.popup_css+=","+b.documentBaseURI.toAbsolute(a.popup_css_add)}b.dom=b.editor.windowManager.createInstance("tinymce.dom.DOMUtils",document,{ownEvents:true,proxy:tinyMCEPopup._eventProxy});b.dom.bind(window,"ready",b._onDOMLoaded,b);if(b.features.popup_css!==false){b.dom.loadCSS(b.features.popup_css||b.editor.settings.popup_css)}b.listeners=[];b.onInit={add:function(e,g){b.listeners.push({func:e,scope:g})}};b.isWindow=!b.getWindowArg("mce_inline");b.id=b.getWindowArg("mce_window_id")},getWin:function(){return(!window.frameElement&&window.dialogArguments)||opener||parent||top},getWindowArg:function(b,a){var c=this.params[b];return tinymce.is(c)?c:a},getParam:function(b,a){return this.editor.getParam(b,a)},getLang:function(b,a){return this.editor.getLang(b,a)},execCommand:function(c,d,e,b){b=b||{};b.skip_focus=1;this.restoreSelection();return this.editor.execCommand(c,d,e,b)},resizeToInnerSize:function(){var a=this;setTimeout(function(){var b=a.dom.getViewPort(window);a.editor.windowManager.resizeBy(a.getWindowArg("mce_width")-b.w,a.getWindowArg("mce_height")-b.h,a.id||window)},10)},executeOnLoad:function(s){this.onInit.add(function(){eval(s)})},storeSelection:function(){this.editor.windowManager.bookmark=tinyMCEPopup.editor.selection.getBookmark(1)},restoreSelection:function(){var a=tinyMCEPopup;if(!a.isWindow&&tinymce.isIE){a.editor.selection.moveToBookmark(a.editor.windowManager.bookmark)}},requireLangPack:function(){var a=this,b=a.getWindowArg("plugin_url")||a.getWindowArg("theme_url");if(b&&a.editor.settings.language&&a.features.translate_i18n!==false&&a.editor.settings.language_load!==false){b+="/langs/"+a.editor.settings.language+"_dlg.js";if(!tinymce.ScriptLoader.isDone(b)){document.write('<script type="text/javascript" src="'+b+'"></script>');tinymce.ScriptLoader.markDone(b)}}},pickColor:function(a,b){this.execCommand("mceColorPicker",true,{color:document.getElementById(b).value,func:function(d){document.getElementById(b).value=d;try{document.getElementById(b).onchange()}catch(e){}}})},openBrowser:function(a,c,b){tinyMCEPopup.restoreSelection();this.editor.execCallback("file_browser_callback",a,document.getElementById(a).value,c,window)},confirm:function(c,a,b){this.editor.windowManager.confirm(c,a,b,window)},alert:function(c,a,b){this.editor.windowManager.alert(c,a,b,window)},close:function(){var b=this;function a(){b.editor.windowManager.close(window);tinymce=tinyMCE=b.editor=b.params=b.dom=b.dom.doc=null}if(tinymce.isOpera){b.getWin().setTimeout(a,0)}else{a()}},_restoreSelection:function(){var a=window.event.srcElement;if(a.nodeName=="INPUT"&&(a.type=="submit"||a.type=="button")){tinyMCEPopup.restoreSelection()}},_onDOMLoaded:function(){var d=tinyMCEPopup,e=document.title,a,b,c;if(d.features.translate_i18n!==false){b=document.body.innerHTML;if(tinymce.isIE){b=b.replace(/ (value|title|alt)=([^"][^\s>]+)/gi,' $1="$2"')}document.dir=d.editor.getParam("directionality","");if((c=d.editor.translate(b))&&c!=b){document.body.innerHTML=c}if((c=d.editor.translate(e))&&c!=e){document.title=e=c}}if(!d.editor.getParam("browser_preferred_colors",false)||!d.isWindow){d.dom.addClass(document.body,"forceColors")}document.body.style.display="";if(tinymce.isIE){document.attachEvent("onmouseup",tinyMCEPopup._restoreSelection);d.dom.add(d.dom.select("head")[0],"base",{target:"_self"})}d.restoreSelection();d.resizeToInnerSize();if(!d.isWindow){d.editor.windowManager.setTitle(window,e)}else{window.focus()}if(!tinymce.isIE&&!d.isWindow){d.dom.bind(document,"focus",function(){d.editor.windowManager.focus(d.id)})}tinymce.each(d.dom.select("select"),function(f){f.onkeydown=tinyMCEPopup._accessHandler});tinymce.each(d.listeners,function(f){f.func.call(f.scope,d.editor)});if(d.getWindowArg("mce_auto_focus",true)){window.focus();tinymce.each(document.forms,function(g){tinymce.each(g.elements,function(f){if(d.dom.hasClass(f,"mceFocus")&&!f.disabled){f.focus();return false}})})}document.onkeyup=tinyMCEPopup._closeWinKeyHandler},_accessHandler:function(a){a=a||window.event;if(a.keyCode==13||a.keyCode==32){var b=a.target||a.srcElement;if(b.onchange){b.onchange()}return tinymce.dom.Event.cancel(a)}},_closeWinKeyHandler:function(a){a=a||window.event;if(a.keyCode==27){tinyMCEPopup.close()}},_eventProxy:function(a){return function(b){tinyMCEPopup.dom.events.callNativeHandler(a,b)}}};tinyMCEPopup.init();